<!DOCTYPE html>
<html lang="zh-hant" xml:lang="zh-hant">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="https://6000-fisc.cdn.hinet.net/Content/img/favicon.ico">
    <link rel="stylesheet" href="https://6000-fisc.cdn.hinet.net/Content/css/reset.css">
    <link rel="stylesheet" href="https://6000-fisc.cdn.hinet.net/Content/css/style.css">
    <title>財政部-全民共享普發現金</title>
</head>
<body>
    <header>
        <noscript><p class="tip">您的瀏覽器不支援JavaScript功能，若網頁功能無法正常使用時，請開啟瀏覽器 JavaScript 為可使用狀態</p></noscript>
        <a href="#content" aria-label="跳到中央內容區塊" tabindex="0" class="getMainBtn">跳到中央內容區塊</a>
        <a href="/" class="logo">
            <p>財政部</p>
        </a>
        <aside>
            <div class="link">
                <!-- 導盲磚快捷鍵設置 -->
                <a accesskey="U" class="guidePoint textWhite" href="javascript:void(0);" aria-label="上方功能區塊">:::</a>
                <button aria-label="誰能領(另開新視窗)" onClick="javascript:window.open(popWindow('WhoCan'),'_blank');">誰能領</button>
                <button aria-label="如何領(另開新視窗)" onClick="javascript:window.open(popWindow('Howto'),'_blank');">如何領</button>
                <button aria-label="直接入帳(另開新視窗)" onClick="javascript:window.open(popWindow('Direct'),'_blank');">直接入帳</button>
                <button aria-label="常見問題(另開新視窗)" onClick="javascript:window.open(popWindow('FAQ'),'_blank');">常見問題</button>
                <button aria-label="防詐騙專區(另開新視窗)" onClick="javascript:window.open(popWindow('Anti'),'_blank');">防詐騙專區</button>
            </div>
            <p class="time" id="datePeriod" aria-label="領取期間:112年3月27日~112年12月31日">領取期間:112年3月27日~112年12月31日</p>
        </aside>
    </header>
    <!-- 所設置的主要內容區塊跳至此處 -->
    <main>
        <section id="content" tabindex="-1" class="contentLayout">
            <a accesskey="C" class="guidePoint" href="javascript:void(0);" aria-label="中央內容區塊">:::</a>
            <div class="indexLeft textCenter">
                <h1>
                    <img alt="全民共享普發現金" src="https://6000-fisc.cdn.hinet.net/Content/img/cash.png">
                </h1>
            </div>
            <div class="indexRight textCenter formColumn">
                <script src="https://6000-fisc.cdn.hinet.net/Content/js/jquery.min.js"></script>
                
<div class="subTitle">
    <h2>資料登記</h2>
    <p>請備妥發放對象之健保卡號 與 本人/代領人之金融機構帳號</p>
</div>
<form action="/Register/Index" id="Register" method="post" role="form"><input name="__RequestVerificationToken" type="hidden" value="-71jJ5qxPMbOHDKluuHhKd_yKILAPVQwIChdqlfdRA7gcCo-xBq9fum9g929kNHTPiF9CedBHLdWYvZIcc5Bb7bBjzMUyZbbO3DnlZksVHY1" />    <div class="hr">
        <fieldset>
            <legend class="visually-hidden">本人/代領人資訊</legend>
            <div class="item">
                <label for="RegisterBE_ParentId">本人/代領人身分證字號或居留證統一證號</label>
                <div>
                    <input MaxLength="10" aria-label="本人/代領人身分證字號或居留證統一證號" id="RegisterBE_ParentId" name="RegisterBE.ParentId" placeholder="10位英數字(必填)" type="text" value="" />
                </div>
            </div>
            <div class="item">
                <label for="RegisterBE_SelectedBank">本人/代領人金融機構代號 <span class="visually-hidden">(限本人同身分證字號之金融機構代號)</span></label>
                <div>
                    <select id="RegisterBE_SelectedBank" name="RegisterBE.SelectedBank" aria-label="選擇金融機構代號(限本人同身分證字號之金融機構代號)">
                        <option label="選擇金融機構代號" selected="selected" value="">請選擇</option>
                    </select>
                    <p class="note" aria-hidden="true">限本人同身分證字號之金融機構代號/帳號</p>
                </div>
            </div>
            <div class="item">
                <label for="RegisterBE_BankAccount">本人/代領人金融機構帳號</label>
                <div>
                    <input MaxLength="16" aria-label="本人/代領人金融機構帳號" id="RegisterBE_BankAccount" name="RegisterBE.BankAccount" placeholder="8-16位數字(必填)" type="text" value="" />
                </div>
            </div>
        </fieldset>
        <fieldset id="childList">
            <legend class="visually-hidden">發放對象健保卡號</legend>
            
            <div class="item" id="healtNum">
                <label for="RegisterBE_HealthId">發放對象健保卡號 <span class="visually-hidden">代領上限為4位(含本人5位)</span></label>
                <div>
                    <div>
                        <input MaxLength="12" aria-label="發放對象健保卡號#1，代領上限為4位(含本人5位)" id="RegisterBE_HealthId" name="RegisterBE.HealthId" placeholder="12位數字(必填)" type="text" value="" />
                        <button id="removeNum" class="r delete" aria-label="刪除卡號#1">刪除</button>
                    </div>
                </div>
            </div>
            <p class="note mlLabel" aria-hidden="true">代領上限為4位(含本人5位)</p>
            <button id="addNum" class="g add indent" aria-label="新增">新增</button>
        </fieldset>
    </div>
    <div class="btns">
        <button class="gray" type="button" aria-label="上一頁" onclick="backFunction();">上一頁</button>
        <button type="button" aria-label="下一頁" onclick="submitFunction();">下一頁</button>
    </div>
<input Length="0" id="RegisterBE_SelectedBank" name="RegisterBE.SelectedBank" type="hidden" value="" /><input id="SelectedBankName" name="SelectedBankName" type="hidden" value="" /><input id="RegisterBE_HiddenHealth" name="RegisterBE.HiddenHealth" type="hidden" value="" /></form>
<script src="https://6000-fisc.cdn.hinet.net/Content/js/bank.js"></script>
<script>
    var alertMsg = '';
    if (alertMsg != '') {
        alert('');
    }

    $(document).ready(function () {
         //多筆自由了
        var MaxInputs = 4;                  //maximum input boxes allowed
        var InputsWrapper = $("#healtNum"); //Input boxes wrapper ID
        var AddButton = $("#addNum");       //Add button ID
        var x = InputsWrapper.length;       //initlal text box count
        var FieldCount = 1;                 //to keep track of text box added
        // 如有使用者以填寫的資料，將重新生成
        if ($("#RegisterBE_HiddenHealth").val()) {
	        let healthIds = $("#RegisterBE_HiddenHealth").val().split(",");
            for (var i = 1; i < healthIds.length; i++)
            {
                let healthIdIndex = i;
                $('.note').last().before('<div class="item"><label for="RegisterBE_HealthId">發放對象健保卡號#' + (healthIdIndex + 1) + '</label><div><div><input type="text" maxlength="12" id="RegisterBE_HealthId" name="RegisterBE.HealthId" aria-label="發放對象健保卡號#' + (healthIdIndex + 1) + '" placeholder="12位數字(必填)" value=""><button id="removeNum" class="r delete" aria-label="刪除卡號#' + (healthIdIndex + 1) + '">刪除</button></div></div></div>');
                let healthIdInputs = $('input[name="RegisterBE.HealthId"]');
                $(healthIdInputs[i]).val(healthIds[i]);
	        }
            x = $('input[name="RegisterBE.HealthId"]').length;
            FieldCount = x;
        }
        var strElement = '';
        if (strElement != '' && isNaN(strElement)) {
            $('input[name="' + strElement + '"]').focus();
        }
        if (strElement != '' && !isNaN(strElement)) {
            let healthIds = $('input[name="RegisterBE.HealthId"]');
            $(healthIds[strElement]).focus();
        }
        $(AddButton).click(function (e)    //on add input button click
        {
            if (x <= MaxInputs)             //max input box allowed
            {
                if (!confirm('確認要新增健保卡號?')) {
                    return false;
                }
                FieldCount++;               //text box added increment
                //add input box
                $('.note').last().before('<div class="item"><label for="RegisterBE_HealthId">發放對象健保卡號#' + FieldCount + '</label><div><div><input type="text" maxlength="12" id="RegisterBE_HealthId" name="RegisterBE.HealthId" aria-label="發放對象健保卡號#' + FieldCount + '" placeholder="12位數字(必填)" value=""><button id="removeNum" class="r delete" aria-label="刪除卡號#' + FieldCount + '">刪除</button></div></div></div>');
                $('input[name="RegisterBE.HealthId"]').last().val("");
                $('input[name="RegisterBE.HealthId"]').last().focus();
                x++; //text box increment
            }
            return  false;
        });
        $("body").on("click", "#removeNum",  function (e) { //user click on remove text
            if (x > 1)
            {
                if (!confirm('確認要刪除健保卡號?')) {
                    return false;
                }
                $(this).parents().eq(2).remove(); //獲取當前元素的父元素的父元素的DIV並刪除
                x--; //decrement textbox
                FieldCount = x;

                //redo bind List
                var div = document.getElementById("childList");
                $(div).find('.item').each(function (index) {
                    $(this).find('input:text').attr('placeholder', '12位數字(必填)');
                    if (index == 0) {
                        $(this).find('label').html('發放對象健保卡號 <span class="visually-hidden">代領上限為4位(含本人5位)</span>');
                        $(this).find('input:text').attr('aria-label', '發放對象健保卡號#1，代領上限為4位(含本人5位)');
                    }
                    else {
                        $(this).find('label').text('發放對象健保卡號#' + (index + 1));
                        $(this).find('input:text').attr('aria-label', '發放對象健保卡號#' + (index + 1));
                    }
                    $(this).find('button').attr('aria-label', '刪除卡號#' + (index + 1));
                });
                //$(div).find('input:text').each(function (index) {
                //    $(this).attr('placeholder', '12位數字(必填)');
                //    $(this).attr('aria-label', '發放對象健保卡號#' + (index + 1));
                //});
                //$(div).find('label').each(function (index) {
                //    alert(index);
                //    alert($(this).text());
                //});
            }
            return  false;
        })
        //多筆結束了
        var obj = BankListData();
		var keys = [];
		for (var prop in obj) {
			keys.push(prop);
		}
		keys.sort();
		for (let i = 0; i < keys.length; i++) {
			var key = keys[i];
			var value = obj[key];
			$("#RegisterBE_SelectedBank").append(new Option(key + value,key,false));
		}
        var selected = '';
        if (selected != '') {
            $("#RegisterBE_SelectedBank").val(selected).change();
        }
    });

    function submitFunction() {

        var bankName = $("#RegisterBE_SelectedBank option:selected").text();
        $("#SelectedBankName").val(bankName);
        if (isConfirm()) {
            // RegisterBE_HealthId

            let healthIds = $('input[name="RegisterBE.HealthId"]');
            let healthIdStr = ""
            for (let i = 0; i < healthIds.length; i++) {
		        let healthIdIndex = i + 1;
                if (i > 0) {
		            healthIdStr += ","
                }
  		        healthIdStr += $(healthIds[i]).val();
	        }
	        $("#RegisterBE_HiddenHealth").val(healthIdStr);
            document.getElementById("Register").submit();
        }
    }
    function backFunction() {
        var destUrl = '/';
        window.location.href = destUrl;
    }
    function isConfirm() {
        var m_msg = "";

        try {
            if (document.getElementById("RegisterBE_ParentId").value == "") {
                m_msg += "*身分證字號或居留證統一證號 未填寫。\r\n";
                document.getElementById("RegisterBE_ParentId").focus();
            }
            if ($("#RegisterBE_SelectedBank option:selected").val() == "") {
                if (m_msg == "") {
                    document.getElementById("RegisterBE_SelectedBank").focus();
                }
                m_msg += "*金融機構代號 未勾選。\r\n";
            }
            if (document.getElementById("RegisterBE_BankAccount").value == "") {
                if (m_msg == "") {
                    document.getElementById("RegisterBE_BankAccount").focus();
                }
                m_msg += "*金融機構帳號 未填寫。\r\n";
            }
            let healthIds = $('input[name="RegisterBE.HealthId"]');
            for (let i = 0; i < healthIds.length; i++) {
                let healthIdIndex = i + 1;
                if ($(healthIds[i]).val() == "") {
                    if (m_msg == "") {
                        $(healthIds[i]).focus();
                    }
                    m_msg += "*健保卡號#" + healthIdIndex + " 未填寫。\r\n";
                }
                //else if ($(healthIds[i]).val().length != 12) {
                //    m_msg += "*健保卡號#" + healthIdIndex + " "  + $(healthIds[i]).val() + " 輸入錯誤。\r\n";
                //}
            }

            if (m_msg != "") {
                alert(m_msg);
                return false;
            }
            return true;
        }
        catch (e) {
            alert(e);
            return false;
        }
    }
</script>

            </div>
        </section>
    </main>
    <footer>
        <div>
            <a accesskey="B" class="guidePoint textWhite" href="javascript:void(0);" aria-label="下方功能區塊">:::</a>
            <a href="/EnRegister" aria-label="切換成英文語系(另開新視窗)" class="linkPage">(中文/English)</a>
            <span class="mobileShow"></span>
            <a href="#" onclick="javascript:window.open(popWindow('agree1'),'_blank');" aria-label="隱私權聲明 (另開新視窗)">隱私權聲明</a>
            <a href="#" onclick="javascript:window.open(popWindow('agree2'),'_blank');" aria-label="個人資料保護法告知義務內容 (另開新視窗)">個人資料保護法告知義務內容</a>
        </div>
        <a href="#" onclick="javascript:window.open(popWindow('AA'),'_blank');" aria-label="通過AA檢測等級無障礙網頁檢測(另開新視窗)">
            <img alt="" src="https://6000-fisc.cdn.hinet.net/Content/img/AA.png" style="height:31px; width:88px">
        </a>
    </footer>
    <script src="https://6000-fisc.cdn.hinet.net/Content/js/javascript.js"></script>
    
    <script>

        $(document).ready(function () {
            var htTxt = $('.subTitle').parent().find('h2').text();
            $(document).attr("title", htTxt + " 財政部-全民共享普發現金");
            date_period();
        });
        // 對button做click事件，以點擊、空白鍵、enter鍵，皆可觸發連結
        function linkUrl(event, url) {
            if (event.type == 'click' || event.type == 'keydown' && event.keyCode == 13 || event.type == 'keydown' && event.keyCode == 32) {
                window.location.href = url;
            }
        }
        function noBack() {
            window.history.forward();
        }
        noBack();
        window.onload = noBack;
        window.onpageshow = function (evt) { if (evt.persisted) noBack() }
        window.onunload = function () { void (0) }
    </script>
</body>
</html>